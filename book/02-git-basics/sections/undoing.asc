[[_undoing]]
=== Възстановяване на направени действия

Във всеки един момент може да се окаже, че искате да отмените дадена промяна по проекта.
Тук ще разгледаме някои основни средства за отмяна на промени.
Бъдете внимателни, защото не винаги може да отмените отмяна!
Това е една от малките области в Git, където можете да загубите част от данните си, ако не действате прецизно.

Едно от най-честите действия по отмяна е да направите къмит твърде рано и да сте забравили да добавите няколко файла или да сте объркали commit съобщението.
Ако искате да опитате този къмит отново, можете да старирате commit с параметъра `--amend`:

[source,console]
----
$ git commit --amend
----

Тази команда взема съдържанието на индекса и го използва за къмита.
Ако не сте правили промени от последния къмит (например, пускате командата веднага след предишния къмит), тогава вашият snapshot ще изглежда по идентичен начин и единственото нещо, което ще промените е commit съобщението.

Ще се отвори същия редактор, но със заредено съобщението от последния къмит.
Можете да промените съобщението както обикновено, но то ще презапише предишния ви къмит.

Като пример, ако къмитнете и веднага след това се сетите, че не сте индексирали промените във файл, който искате да влиза в къмита, можете да направите следното:

[source,console]
----
$ git commit -m 'initial commit'
$ git add forgotten_file
$ git commit --amend
----

Ще си останете с един къмит - вторият замества резултатите от първия.

[[_unstaging]]
==== Изваждане на файл от индекса

Следващите две секции демонстрират как се работи с индексната област и промените в работната директория.
Хубавото е, че командата, която използвате за да определите статуса на тези две области, също така ви подсказва и как да отменяте направени в тях промени.
За пример, нека кажем, че сте променили два файла и искате да ги къмитнете като две отделни промени, но неволно сте изпълнили `git add *` и сте ги индексирали и двата.
Как да извадите от индекса единия от двата?
Командата `git status` ви подсказва начина:

[source,console]
----
$ git add *
$ git status
On branch master
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    renamed:    README.md -> README
    modified:   CONTRIBUTING.md
----

Точно под текста ``Changes to be committed'', пише `git reset HEAD <file>...` to unstage.
Да ползваме този съвет за да деиндексираме файла `CONTRIBUTING.md`:

[source,console]
----
$ git reset HEAD CONTRIBUTING.md
Unstaged changes after reset:
M	CONTRIBUTING.md
$ git status
On branch master
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    renamed:    README.md -> README

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   CONTRIBUTING.md
----

Командата е леко странна, но работи.
Файлът `CONTRIBUTING.md` сега си е променен, но вече не е в индекса

[NOTE]
=====
Вярно е, че `git reset` може да се окаже опасна команда, особено ако ѝ подадете флага `--hard`.
Обаче, в горния случай, файлът в работната ви директория е недокоснат, така че тя е сравнително безопасна.
=====

Към момента, това магическо извикване е всичко, което трябва да знаете за `git reset` командата.
Ще навлезем в много по-дълбоки подробности за това какво прави `reset` и как да я ползваме за да правим наистина интересни неща в <<_git_reset>>.

==== Отмяна на промените в променен файл

Какво се случва, ако установите, че не искате да пазите промените си във файла `CONTRIBUTING.md`?
Как можем лесно да го "де-модифицираме" - тоест да го превъртим назад до съдържанието, което е имал при последния къмит (или както е бил при първоначалното клониране в работната ви директория)?
За късмет, `git status` ни подсказва и това.
В последния ни пример, работната област изглеждаше така:

[source,console]
----
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   CONTRIBUTING.md
----

Това ви казва доста недвусмислено как да отмените промените, които сте направили.
Нека да го изпълним:

[source,console]
----
$ git checkout -- CONTRIBUTING.md
$ git status
On branch master
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    renamed:    README.md -> README

----

Можете да се уверите, че промените изчезнаха.

[IMPORTANT]
=====
Важно е да се разбере, че `git checkout -- <file>` е опасна команда.
Всички промени, които сте правили по този файл ще изчезнат необратимо - Git просто копира друг файл върху него.
Никога не ползвайте тази команда, освен ако не сте абсолютно сигурни, че не желаете промените във файла.
=====

If you would like to keep the changes you've made to that file but still need to get it out of the way for now, we'll go over stashing and branching in <<_git_branching>>; these are generally better ways to go.

Remember, anything that is _committed_ in Git can almost always be recovered.
Even commits that were on branches that were deleted or commits that were overwritten with an `--amend` commit can be recovered (see <<_data_recovery>> for data recovery).
However, anything you lose that was never committed is likely never to be seen again.
